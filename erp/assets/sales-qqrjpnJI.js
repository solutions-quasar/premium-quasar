import{ak as o,ap as c,aq as s,an as i,ao as r,ar as n,as as l,at as d}from"./index-CbDRgnMc.js";const f=o("sales",{state:()=>({invoices:[],loading:!1,unsubscribe:null}),actions:{init(){if(this.unsubscribe)return;this.loading=!0;const a=n(s(i,"invoices"),l("createdAt","desc"));this.unsubscribe=d(a,e=>{this.invoices=e.docs.map(t=>({id:t.id,...t.data()})),this.loading=!1},e=>{console.error("Error fetching invoices:",e),this.loading=!1})},async createInvoice(a){try{const e=await c(s(i,"invoices"),{...a,createdAt:new Date().toISOString(),status:"Draft",total:this.calculateTotal(a.items)});return r.create({type:"positive",message:"Invoice created"}),e.id}catch(e){console.error("Error adding invoice:",e),r.create({type:"negative",message:"Failed to create invoice"})}},calculateTotal(a){return a?a.reduce((e,t)=>e+t.qty*t.price,0):0}}});export{f as u};
