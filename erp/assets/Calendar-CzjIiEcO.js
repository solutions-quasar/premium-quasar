import{c as W,t as N,h as J,O as K,ak as X,al as Z,am as ee,an as T,ao as $,ap as te,aq as A,ar as ae,as as ne,at as le,r as Q,d as oe,e as V,o as r,w as o,f as a,Q as se,g as re,i as ie,j as M,k as w,l as de,m as g,n as E,p as ue,_ as ce,s as me,q as fe,v as ge,y as p,F as x,D as B,z as h,au as L,B as F,ad as ve,ae as pe,af as I,C as ye,aj as U,G as he}from"./index-CbDRgnMc.js";import{Q as _e}from"./QPageSticky-BFt7GIaD.js";import{Q as we}from"./QSelect-_JWn2mpf.js";import{Q as De}from"./QForm-EsKp3e1C.js";import{C as be}from"./ClosePopup-BhcXByJZ.js";import"./QMenu-DLozQkxR.js";const ke=W({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(u,{slots:l}){const f=N(()=>{const v=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(c=>u[c]===!0).map(c=>`q-btn-group--${c}`).join(" ");return`q-btn-group row no-wrap${v.length!==0?" "+v:""}`+(u.spread===!0?" q-btn-group--spread":" inline")});return()=>J("div",{class:f.value},K(l.default))}}),O=X("events",{state:()=>({events:[],loading:!1,unsubscribe:null}),actions:{init(){if(this.unsubscribe)return;this.loading=!0;const u=ae(A(T,"events"),ne("start","asc"));this.unsubscribe=le(u,l=>{this.events=l.docs.map(f=>({id:f.id,...f.data()})),this.loading=!1},l=>{console.error("Error fetching events:",l),this.loading=!1})},async addEvent(u){try{await te(A(T,"events"),{...u,createdAt:new Date().toISOString()}),$.create({type:"positive",message:"Event added"})}catch(l){console.error("Error adding event:",l),$.create({type:"negative",message:"Failed to add event"})}},async deleteEvent(u){try{await Z(ee(T,"events",u)),$.create({type:"positive",message:"Event deleted"})}catch(l){console.error(l)}}},getters:{upcomingEvents:u=>{const l=new Date().toISOString();return u.events.filter(f=>f.start>=l)}}}),Ce={class:"row q-col-gutter-sm"},Se={class:"col-6"},Ee={class:"col-6"},xe={__name:"AddEventDialog",emits:["close"],setup(u,{emit:l}){const f=l,v=O(),c=Q(!1),_=new Date;_.setMinutes(0,0,0);const D=new Date(_.getTime()+3600*1e3),i=oe({title:"",start:b(_),end:b(D),type:"Sales Meeting",details:""});function b(C){return C.toISOString().slice(0,16)}async function k(){c.value=!0,await v.addEvent(i),c.value=!1,f("close")}return(C,s)=>(r(),V(ue,{class:"bg-dark text-white"},{default:o(()=>[a(se,null,{default:o(()=>[a(ie,null,{default:o(()=>[...s[5]||(s[5]=[M("New Event",-1)])]),_:1}),re(a(w,{flat:"",round:"",dense:"",icon:"close"},null,512),[[be]])]),_:1}),a(de,null,{default:o(()=>[a(De,{onSubmit:k,class:"q-gutter-md"},{default:o(()=>[a(E,{modelValue:i.title,"onUpdate:modelValue":s[0]||(s[0]=d=>i.title=d),label:"Event Title",filled:"",dark:"",color:"primary",rules:[d=>!!d||"Required"]},null,8,["modelValue","rules"]),g("div",Ce,[g("div",Se,[a(E,{modelValue:i.start,"onUpdate:modelValue":s[1]||(s[1]=d=>i.start=d),type:"datetime-local",label:"Start",filled:"",dark:"",color:"primary"},null,8,["modelValue"])]),g("div",Ee,[a(E,{modelValue:i.end,"onUpdate:modelValue":s[2]||(s[2]=d=>i.end=d),type:"datetime-local",label:"End",filled:"",dark:"",color:"primary"},null,8,["modelValue"])])]),a(we,{modelValue:i.type,"onUpdate:modelValue":s[3]||(s[3]=d=>i.type=d),options:["Sales Meeting","Team Meeting","Cold Call Block","Follow Up","Custom"],label:"Type",filled:"",dark:"",color:"primary"},null,8,["modelValue"]),a(E,{modelValue:i.details,"onUpdate:modelValue":s[4]||(s[4]=d=>i.details=d),label:"Details",type:"textarea",filled:"",dark:"",color:"primary"},null,8,["modelValue"]),a(w,{label:"Create Event",type:"submit",color:"primary",class:"full-width q-mt-md",loading:c.value},null,8,["loading"])]),_:1})]),_:1})]),_:1}))}},Be={class:"row items-center justify-between q-mb-md"},Qe={class:"row q-gutter-sm"},Ve={key:0,class:"calendar-container animate-fade"},Me={class:"calendar-header"},qe={class:"calendar-grid"},Te=["onClick"],$e={class:"day-number"},Fe={class:"day-events"},Ie={key:0,class:"text-tiny text-grey"},Ue={key:1,class:"animate-fade"},Ne={key:0,class:"text-center text-grey q-mt-xl"},je={__name:"Calendar",setup(u){const l=O(),{events:f}=me(l),v=Q("month"),c=Q(!1),_=Q(new Date);fe(()=>{l.init()});const D=N(()=>[...f.value].sort((e,n)=>new Date(e.start)-new Date(n.start))),i=N(()=>{const e=_.value.getFullYear(),n=_.value.getMonth(),t=new Date(e,n,1),S=new Date(e,n+1,0),y=[],j=t.getDay();for(let m=0;m<j;m++)y.push({date:new Date(e,n,-j+1+m),currentMonth:!1});for(let m=1;m<=S.getDate();m++){const z=new Date(e,n,m),R=f.value.filter(H=>{const q=new Date(H.start);return q.getDate()===m&&q.getMonth()===n&&q.getFullYear()===e});y.push({date:z,currentMonth:!0,isToday:b(z,new Date),events:R})}const G=42-y.length;for(let m=1;m<=G;m++)y.push({date:new Date(e,n+1,m),currentMonth:!1});return y});function b(e,n){return e.getDate()===n.getDate()&&e.getMonth()===n.getMonth()&&e.getFullYear()===n.getFullYear()}function k(e){return new Date(e).toLocaleString("en-US",{hour:"numeric",minute:"2-digit",weekday:"short"})}function C(e){return e==="Sales Meeting"?"bg-positive":e==="Team Meeting"?"bg-info":e==="Cold Call Block"?"bg-warning":"bg-grey"}function s(e){return e==="Sales Meeting"?"positive":e==="Team Meeting"?"info":e==="Cold Call Block"?"warning":"grey"}function d(e){return e==="Sales Meeting"?"handshake":e==="Team Meeting"?"groups":e==="Cold Call Block"?"phone_callback":"event"}function P(e){console.log(e)}function Y(e){confirm("Delete event?")&&l.deleteEvent(e)}return(e,n)=>(r(),V(ge,{class:"q-pa-md pb-safe"},{default:o(()=>[g("div",Be,[n[5]||(n[5]=g("div",{class:"text-h4 text-primary"},"Calendar",-1)),g("div",Qe,[a(ke,{outline:""},{default:o(()=>[a(w,{outline:"",color:v.value==="month"?"primary":"grey",label:"Month",onClick:n[0]||(n[0]=t=>v.value="month")},null,8,["color"]),a(w,{outline:"",color:v.value==="list"?"primary":"grey",label:"Agenda",onClick:n[1]||(n[1]=t=>v.value="list")},null,8,["color"])]),_:1})])]),v.value==="month"?(r(),p("div",Ve,[g("div",Me,[(r(),p(x,null,B(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=>g("div",{key:t,class:"text-center text-grey q-py-sm"},h(t),1)),64))]),g("div",qe,[(r(!0),p(x,null,B(i.value,(t,S)=>(r(),p("div",{key:S,class:L(["calendar-day text-white relative-position",{"opacity-30":!t.currentMonth,today:t.isToday}]),onClick:y=>P(t)},[g("div",$e,h(t.date.getDate()),1),g("div",Fe,[(r(!0),p(x,null,B(t.events,y=>(r(),p("div",{key:y.id,class:L(["event-dot",C(y.type)])},null,2))),128)),t.events.length>3?(r(),p("div",Ie,"+"+h(t.events.length-3),1)):F("",!0)])],10,Te))),128))])])):(r(),p("div",Ue,[a(ve,{separator:"",dark:""},{default:o(()=>[(r(!0),p(x,null,B(D.value,t=>(r(),V(pe,{key:t.id,class:"q-py-md"},{default:o(()=>[a(I,{avatar:"",top:""},{default:o(()=>[a(ye,{name:d(t.type),color:s(t.type),size:"md"},null,8,["name","color"])]),_:2},1024),a(I,null,{default:o(()=>[a(U,{class:"text-h6"},{default:o(()=>[M(h(t.title),1)]),_:2},1024),a(U,{caption:"",class:"text-grey"},{default:o(()=>[M(h(k(t.start))+" - "+h(k(t.end)),1)]),_:2},1024),t.details?(r(),V(U,{key:0,caption:"",class:"text-grey-5"},{default:o(()=>[M(h(t.details),1)]),_:2},1024)):F("",!0)]),_:2},1024),a(I,{side:""},{default:o(()=>[a(w,{flat:"",round:"",icon:"delete",color:"negative",size:"sm",onClick:S=>Y(t.id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),D.value.length===0?(r(),p("div",Ne," No upcoming events. ")):F("",!0)])),a(_e,{position:"bottom-right",offset:[18,18]},{default:o(()=>[a(w,{fab:"",icon:"add",color:"primary",onClick:n[2]||(n[2]=t=>c.value=!0)})]),_:1}),a(he,{modelValue:c.value,"onUpdate:modelValue":n[4]||(n[4]=t=>c.value=t)},{default:o(()=>[a(xe,{onClose:n[3]||(n[3]=t=>c.value=!1)})]),_:1},8,["modelValue"])]),_:1}))}},Ge=ce(je,[["__scopeId","data-v-494cc67a"]]);export{Ge as default};
